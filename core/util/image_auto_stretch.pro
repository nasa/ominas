;================================================================================
; image_auto_stretch
;
;================================================================================
function image_auto_stretch, image, min=min, max=max

 ;---------------------------------------------------------------
 ; min value is not adjusted
 ;---------------------------------------------------------------
 min = 0

 ;---------------------------------------------------------------
 ; find max value by thresholding istogram
 ;---------------------------------------------------------------
 h = histogram(image)
 nh = n_elements(h)
 h[nh-1] = 0
 hs = smooth(h,2)

 w = where(hs GT 1)
 max = max(w)

 return, bytscl(image, min=min, max=max) 
end
;================================================================================
